/*! coffee-classifier - v0.0.1 - 2013-04-24 */var Classifier,STOP_WORDS,stemmer;stemmer=null!=stemmer?stemmer:function(t){return t},STOP_WORDS="a,able,about,across,after,all,almost,also,am,among,an,and,any,are,as,at,be,because,been,but,by,can,cannot,could,dear,did,do,does,either,else,ever,every,for,from,get,got,had,has,have,he,her,hers,him,his,how,however,i,if,in,into,is,it,its,just,least,let,like,likely,may,me,might,most,must,my,neither,no,nor,not,of,off,often,on,only,or,other,our,own,rather,said,say,says,she,should,since,so,some,than,that,the,their,them,then,there,these,they,this,tis,to,too,twas,us,wants,was,we,were,what,when,where,which,while,who,whom,why,will,with,would,yet,you,your",Classifier=function(){function t(t){var e;null!=t?(this.feature_count=t.feature_count,this.klass_count=t.klass_count):(this.feature_count={},this.klass_count={}),e=STOP_WORDS.replace(/,/g,"\\b|\\b"),e="\\b"+e+"\\b",this.stop_words=RegExp(e,"ig")}return t.prototype.to_object=function(){return{feature_count:this.feature_count,klass_count:this.klass_count}},t.prototype.get_features=function(t){var e,s,o,n,i,r,a,u;for(t=t.toLowerCase(),t=t.replace(this.stop_words,""),t=t.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g," "),t=t.replace(/^\s+|\s+$/g,""),t=t.replace(/[ ]+/g," "),s=t.split(" "),n={},r=0,a=s.length;a>r;r++)e=s[r],n[stemmer(e)]=1;u=[];for(o in n)i=n[o],u.push(o);return u},t.prototype.train=function(t,e){var s,o,n,i,r;for(o=this.get_features(t),i=0,r=o.length;r>i;i++)s=o[i],n=this.feature_count[s]||{},n[e]=e in n?n[e]+1:1,this.feature_count[s]=n;return o.length?this.klass_count[e]=e in this.klass_count?this.klass_count[e]+1:1:void 0},t.prototype.untrain=function(t,e){var s,o,n,i,r;for(o=this.get_features(t),i=0,r=o.length;r>i;i++)s=o[i],n=this.feature_count[s],n[e]-=1;return o.length?this.klass_count[e]-=1:void 0},t.prototype.rename_class=function(t,e){var s,o,n,i;i=this.feature_count;for(o in i)n=i[o],n.hasOwnProperty(t)&&(s=n[t],n[e]=n.hasOwnProperty(e)?n[e]+s:s,delete n[t]);return s=this.klass_count[t],delete this.klass_count[t],this.klass_count[e]=this.klass_count.hasOwnProperty(e)?this.klass_count[e]+s:s},t.prototype.delete_class=function(t){var e,s,o;o=this.feature_count;for(e in o)s=o[e],s.hasOwnProperty(t)&&delete s[t];return delete this.klass_count[t]},t.prototype.documents_in_class_count=function(t){return t in this.klass_count?this.klass_count[t]:0},t.prototype.total_documents_count=function(){var t,e,s,o;s=0,o=this.klass_count;for(e in o)t=o[e],s+=t;return s},t.prototype.feature_probability=function(t,e){return!e in this.klass_count?0:t in this.feature_count&&e in this.feature_count[t]?this.feature_count[t][e]/this.klass_count[e]:0},t.prototype.weighted_probability=function(t,e,s,o){var n,i,r;if(null==s&&(s=.5),null==o&&(o=1),n=this.feature_probability(t,e),i=0,t in this.feature_count)for(e in this.feature_count[t])i+=this.feature_count[t][e];return r=(o*s+i*n)/(o+i)},t}();var NaiveBayesClassifier,__hasProp={}.hasOwnProperty,__extends=function(t,e){function s(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t};NaiveBayesClassifier=function(t){function e(t,s,o){null==s&&(s=1e-6),this["default"]=null!=o?o:"Uncategorized",e.__super__.constructor.call(this,t),this.threshold=Math.log(s)}return __extends(e,t),e.prototype.prob_document_given_category=function(t,e,s){var o,n,i,r;for(s=null!=s?s:this.get_features(t),n=0,i=0,r=s.length;r>i;i++)o=s[i],n+=Math.log(this.weighted_probability(o,e));return n},e.prototype.prob_category_given_document=function(t,e,s){var o,n;return o=Math.log(this.documents_in_class_count(e)/this.total_documents_count()),n=this.prob_document_given_category(t,e,s),n+o},e.prototype.classify=function(t){var e,s,o,n,i,r;if(o=this.get_features(t),!o.length)return this["default"];i=Math.log(this.threshold),r={},s=this.threshold;for(n in this.klass_count)r[n]=this.prob_category_given_document(t,n,o),r[n]>s&&(s=r[n],e=n);return s>this.threshold?e:this["default"]},e}(Classifier);