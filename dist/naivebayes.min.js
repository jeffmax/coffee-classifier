/*! coffee-classifier - v0.0.1 - 2013-04-21 */var Classifier,STOP_WORDS,stemmer;stemmer=null!=stemmer?stemmer:function(t){return t},STOP_WORDS="a,able,about,across,after,all,almost,also,am,among,an,and,any,are,as,at,be,because,been,but,by,can,cannot,could,dear,did,do,does,either,else,ever,every,for,from,get,got,had,has,have,he,her,hers,him,his,how,however,i,if,in,into,is,it,its,just,least,let,like,likely,may,me,might,most,must,my,neither,no,nor,not,of,off,often,on,only,or,other,our,own,rather,said,say,says,she,should,since,so,some,than,that,the,their,them,then,there,these,they,this,tis,to,too,twas,us,wants,was,we,were,what,when,where,which,while,who,whom,why,will,with,would,yet,you,your",Classifier=function(){function t(t){var e;null!=t?(this.feature_count=t.feature_count,this.klass_count=t.klass_count):(this.feature_count={},this.klass_count={}),e=STOP_WORDS.replace(/,/g,"\\b|\\b"),e="\\b"+e+"\\b",this.stop_words=RegExp(e,"ig")}return t.prototype.to_object=function(){return{feature_count:this.feature_count,klass_count:this.klass_count}},t.prototype.get_features=function(t){var e,o,s,r,n,i,a,u;for(t=t.toLowerCase(),t=t.replace(this.stop_words,""),t=t.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g," "),t=t.replace(/^\s+|\s+$/g,""),t=t.replace(/[ ]+/g," "),o=t.split(" "),r={},i=0,a=o.length;a>i;i++)e=o[i],r[stemmer(e)]=1;u=[];for(s in r)n=r[s],u.push(s);return u},t.prototype.train=function(t,e){var o,s,r,n,i;for(s=this.get_features(t),n=0,i=s.length;i>n;n++)o=s[n],r=this.feature_count[o]||{},r[e]=e in r?r[e]+1:1,this.feature_count[o]=r;return s.length?this.klass_count[e]=e in this.klass_count?this.klass_count[e]+1:1:void 0},t.prototype.untrain=function(t,e){var o,s,r,n,i;for(s=this.get_features(t),n=0,i=s.length;i>n;n++)o=s[n],r=this.feature_count[o],r[e]-=1;return s.length?this.klass_count[e]-=1:void 0},t.prototype.rename_class=function(t,e){var o,s,r,n;n=this.feature_count;for(s in n)r=n[s],r.hasOwnProperty(t)&&(o=r[t],r[e]=r.hasOwnProperty(e)?r[e]+o:o,delete r[t]);return o=this.klass_count[t],delete this.klass_count[t],this.klass_count[e]=this.klass_count.hasOwnProperty(e)?this.klass_count[e]+o:o},t.prototype.documents_in_class_count=function(t){return t in this.klass_count?this.klass_count[t]:0},t.prototype.total_documents_count=function(){var t,e,o,s;o=0,s=this.klass_count;for(e in s)t=s[e],o+=t;return o},t.prototype.feature_probability=function(t,e){return!e in this.klass_count?0:t in this.feature_count&&e in this.feature_count[t]?this.feature_count[t][e]/this.klass_count[e]:0},t.prototype.weighted_probability=function(t,e,o,s){var r,n,i;if(null==o&&(o=.5),null==s&&(s=1),r=this.feature_probability(t,e),n=0,t in this.feature_count)for(e in this.feature_count[t])n+=this.feature_count[t][e];return i=(s*o+n*r)/(s+n)},t}();var NaiveBayesClassifier,__hasProp={}.hasOwnProperty,__extends=function(t,e){function o(){this.constructor=t}for(var s in e)__hasProp.call(e,s)&&(t[s]=e[s]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};NaiveBayesClassifier=function(t){function e(t,o,s){null==o&&(o=1e-6),this["default"]=null!=s?s:"Uncategorized",e.__super__.constructor.call(this,t),this.threshold=Math.log(o)}return __extends(e,t),e.prototype.prob_document_given_category=function(t,e,o){var s,r,n,i;for(o=null!=o?o:this.get_features(t),r=0,n=0,i=o.length;i>n;n++)s=o[n],r+=Math.log(this.weighted_probability(s,e));return r},e.prototype.prob_category_given_document=function(t,e,o){var s,r;return s=Math.log(this.documents_in_class_count(e)/this.total_documents_count()),r=this.prob_document_given_category(t,e,o),r+s},e.prototype.classify=function(t){var e,o,s,r,n,i;if(s=this.get_features(t),!s.length)return this["default"];n=Math.log(this.threshold),i={},o=this.threshold;for(r in this.klass_count)i[r]=this.prob_category_given_document(t,r,s),i[r]>o&&(o=i[r],e=r);return o>this.threshold?e:this["default"]},e}(Classifier);